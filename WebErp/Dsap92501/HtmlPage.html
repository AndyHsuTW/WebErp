<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="/WebErp/public/scripts/jQuery/jquery-1.12.4.min.js"></script>
    <script>

        var files;

        // Add events
        $(document).ready(function () {
            $('#ImportExcelInput').on('change', prepareUpload);
            $("#Submit").click(function () {
                var formData = new FormData();
                for (var i = 0; i < files.length; i++) {
                    formData.append("file", files[i])
                }

                $.ajax({
                    url: "/WebErp/Dsap92501/Ajax/ImportExcels.ashx",
                    type: 'POST',
                    data: formData,
                    cache: false,
                    dataType: 'text',
                    processData: false,
                    contentType: false,
                    success: function (result) {
                       
                    },
                    error: function (jqXhr, textStatus, errorThrown) {
                        
                        console.error(errorThrown);
                        alert("匯入失敗");
                    }
                });



            });

        });

       

        // Grab the files and set them to our variable
        function prepareUpload(event) {
            files = event.target.files;
        }
    </script>
</head>


<body>
    <input type="file" id="ImportExcelInput" ref="ImportExcelInput" accept=".csv,.xls,.xlsx" multiple>
    <input type ="button" value="Submit" id="Submit"/>

</body>

</html>
